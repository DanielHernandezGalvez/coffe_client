---
import { CategoriesSlugSchema } from "@/types";
import { CategorySchema } from "@/types";

export async function getStaticPaths() {
    const res = await fetch(`${import.meta.env.API_URL}/categories?_fields=slug`);
    const json = await res.json();
    const categories = CategoriesSlugSchema.parse(json)
    return categories.map(category => ({
        params: {slug: category.slug}
    })) 
}

const { slug } = Astro.params;
const catUrl = `${import.meta.env.API_URL}/categories?slug=${slug}`;
const catRes = await fetch(catUrl);
const catJson = await catRes.json();
const category = CategorySchema.parse(catJson[0])
console.log(category)
---

<h1>desde categor√≠a</h1>